<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="author" content="TeliuTe" />
<meta name="Copyright" content="TeliuTe,86团学校,基础教程网" />
<meta name="description" content="基础教程网,TeliuTe系列教程，一步一步教你学会使用电脑" />
<meta name="keywords" content="Flash,Photoshop,3DS Max,VB,VC,Frongpage,XP,TeliuTe,86团学校,教程,基础,入门" />
<title>VC++基础|程序框架</title>
</head>

<body bgcolor="#CCFFFF" vlink="#0000FF">

<p align="center"><b><font color="#FF0000" size="6" face="华文中宋">Windows </font></b><font face="华文彩云" color="#FF0000" size="6">编程</font><font face="华文彩云" color="#FF0000" size="6">基础</font></p> 
<p align="left" style="line-height: 150%; margin: 0"><font color="#0000FF">一、程序框架　</font><a href="../index.htm">返回</a>          
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　<font color="#0000FF">Windows</font>窗口华丽大方， 
框架组成也很<font color="#800000">复杂</font>，一般来说一个应用程序往往包括以下组成部分：                    
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　<font color="#0000FF">1、基本</font>窗口            
包括标题栏和四个边框构成的工作区，这是程序的基本<font color="#800000">框架</font>，所有显示的文字、图片、对话框都是在这个窗口框架当中显示，如果这个窗口关闭，那么相应的所有内容也都会关闭，有时也称作“<font color="#800000">父窗口</font>”；</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font color="#0000FF">　2、程序</font>菜单、显示的文字、图片、弹出式对话框这些都是作为程序使用到的<font color="#800000">资源</font>；                    
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　<font color="#0000FF">3、基于</font>对话框上所显示的标签、文本框、列表框、滚动条等等称作是<font color="#800000">控件</font>，它们可以完成一些特定的功能，它们不能独立存在；                    
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　<font color="#0000FF">4、键盘</font>、显示器是输入输出<font color="#800000">设备</font>，归Windows系统管理，应用程序使用之前需要向系统<font color="#800000">申请</font>；                    
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　<font color="#0000FF">5、程序</font>的启动、运行，各个组件之间，是通过“<font color="#800000">消息</font>”相互沟通的，程序启动后会自动发出一个“创建”消息，向系统<font color="#800000">申请</font>内存、调入资源、构建程序窗口；</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　比较常见的是鼠标消息，鼠标单击、双击或者移动什么的，都会<font color="#800000">发送</font>出相应的消息，程序就会<font color="#800000">显示</font>一小段文字提示，要不就是按钮弹起来按下去等等，</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　有的消息<font color="#800000">系统</font>帮着处理了，有的消息就得程序<font color="#800000">自己</font>动手处理
；</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp;            
下面我们来创建一个较为<font color="#800000">完整</font>的应用程序窗口：          
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp; <font color="#0000FF">1、启动</font>VC，新建一个名为“<font color="#800000">SmlWin</font>”的Win32             
Application<font color="#800000">工程</font>，工程位置在<font color="#800000">自己的</font>文件夹中；          
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp; <font color="#0000FF">2、新建</font>一个名为“SmlWin”的<font color="#800000">头文件</font>，方法是单击“新建”命令，在左边选择C＋＋源程序<font color="#800000">上面的</font><b><font face="宋体">C/C＋＋             
Header File</font></b> ，再在<font color="#800000">右边空白</font>“文件”名称输入SmlWin，单击“确定”，</p> 
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　头文件包含源程序文件用到的函数<font color="#800000">申明</font>，输入下面的代码（<font color="#008000">绿色部分是注释，必须以双斜杠“//”开头，先可以不输入</font>），</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　有的一行太长会自动折到下一行，代码先<font color="#800000">抄到</font>本子上，或者打印出来， 
注意<b>I</b>和<b>l</b>两个字母不同，代码使用<font color="#800000">缩进</font>格式，规范化；                 
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font color="#008000">//代码开始</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font color="#008000">//申明一些源程序（SmlWin.cpp）中用到的函数原型；<br>
//申明和定义分开，互不干扰，定义在源程序中；<br>
//定义好的函数，在WinMain主函数中调用；<br>
</font><br>
<b><font face="Arial">
LRESULT CALLBACK MainWndProc(HWND,U</font><font face="宋体">I</font><font face="Arial">NT,WPARAM,LPARAM);</font><font face="宋体"><br>             
</font></b> 
<font color="#008000">//申明一个消息处理函数</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font color="#008000"><br>
</font><b><font face="Arial">BOOL</font><font face="宋体"> I</font><font face="Arial">nitApp</font>l<font face="Arial">ication(H</font><font face="宋体">I</font><font face="Arial">NSTANCE);</font><font face="宋体"><br>            
</font></b> 
<font color="#008000">//申明一个初始化窗口的函数</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><br>
<b><font face="Arial">BOOL</font><font face="宋体">
I</font><font face="Arial">nit</font><font face="宋体">I</font><font face="Arial">nstance(H</font><font face="宋体">I</font><font face="Arial">NSTANCE,</font><font face="宋体"><font color="#0000FF">int</font></font><font face="Arial">);</font><font face="宋体"><br>           
</font></b> 
<font color="#008000">//申明一个创建窗口的函数</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><br>
<b><font face="宋体"><font color="#0000FF">
char</font> *</font><font face="Arial">myStr</font>=&quot;拉开窗帘，阳光照射进来。&quot;<font face="Arial">;</font><font face="宋体"><br>            
</font></b>
<font color="#008000">//申明并定义一个用到的字符串</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">　          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp; <font color="#0000FF">3、新建</font>一个名为“SmlWin”的C＋＋源程序文件，单击“确定”进入文本区输入下面的程序：                    
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><br>
<font color="#008000">///////////////////////////////<br>
// 程序名：SmlWin.cpp<br>            
// 用途是：显示一个简单窗口<br>            
///////////////////////////////<br>
//包含头文件*.h</font><br>
<b><font face="宋体"><font color="#0000FF">
#include</font> </font><font face="Arial">&lt;windows.h></font></b> <font color="#008000"> //运行在Windows系统下</font><br>           
<b><font face="宋体"><font color="#0000FF">
#include</font> &lt;string.h></font></b> <font color="#008000">  //用到字符串</font><br>           
<b><font face="宋体"><font color="#0000FF">
#include</font> "</font><font face="Arial">Sm</font>l<font face="Arial">Win.h</font><font face="宋体">"</font></b> <font color="#008000"> //函数的申明</font><br>           
<br>
<b><font face="Arial">H</font><font face="宋体">I</font><font face="Arial">NSTANCE h</font><font face="宋体">I</font><font face="Arial">nst;</font></b><font color="#008000">//申明当前实例句柄</font><br>           
<b><font face="Arial">HWND hWndMain;</font></b> <font color="#008000">  //申明主窗口句柄</font>           
<br>
<br>
<font color="#008000">////////////////////////////////////////////////////<br>
//  函数名： WinMain(HINSTANCE,HINSTNCE,LPSTR,int)<br>            
//	用途是： 程序入口，调用初始化函数，处理消息循环，<br>            
////////////////////////////////////////////////////<br>
</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><b><font color="#0000FF">int</font> 
<font face="Arial">A</font>PIENTRY Win<font face="Arial">M</font>ain(</b><font color="#008000">//主函数有四个参数</font><br> 
<b>&nbsp;&nbsp;&nbsp;</b> <b>HINSTANCE&nbsp; hInstance,</b><font color="#008000">//当前实例句柄</font><br>           
<b>&nbsp;&nbsp;&nbsp;</b> <b>HINSTANCE&nbsp; hPrevInstance,</b><font color="#008000">//前一实例句柄</font><br>           
<b>&nbsp;&nbsp;&nbsp;</b> <b>LPSTR&nbsp; lpCmdLine,</b><font color="#008000">//命令行字符串</font><br>           
<b>&nbsp;&nbsp;&nbsp;</b> <b><font color="#0000FF">int</font> nCmdShow)</b><font color="#008000">//窗口显示方式</font><br>           
<font color="#008000">&nbsp;&nbsp;&nbsp; //函数头结束，开始定义函数<br>
</font><br>
<b><font face="Arial">{</font></b><br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b><font face="Arial">MSG msg;</font></b><font color="#008000"> //申明一个消息，消息是结构变量；<br>            
</font><br>
<font color="#008000">	&nbsp;&nbsp;&nbsp; //调用函数，初始化窗口数据，并注册窗口类；<br>          
</font>	<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font><font color="#008000"> 
</font><b><font face="宋体"><font color="#0000FF">if</font>(!Init</font><font face="Arial">A</font><font face="宋体">pplication(hInstance))</font></b><font face="宋体"><font color="#008000">//调用InitApplication函数</font></font> 
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font face="宋体"><b>{</b></font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp;&nbsp;&nbsp;<b><font face="宋体"> </font>                  
          
               
<font face="Arial">M</font><font face="宋体">essageBox(NULL,&quot;Init</font><font face="Arial">A</font><font face="宋体">pplication函数错误&quot;,&quot;提示&quot;,</font><font face="Arial">MB</font><font face="宋体">_OK);</font></b>                  
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp;&nbsp;&nbsp; <font color="#008000">//用于调试，找出程序没反应的错误</font><b><font face="宋体"><br>        
&nbsp;&nbsp;&nbsp; <font color="#0000FF">return</font> (F</font><font face="Arial">A</font><font face="宋体">LSE);</font></b>                   
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font face="宋体"><b>}<br>   
</b></font> 
<br>
<font color="#008000">	&nbsp;&nbsp;&nbsp;          
</font>	 
<font color="#008000">	//调用函数，创建和显示窗口；<br>
</font>	<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font><font color="#008000"> 
</font><b><font face="宋体"><font color="#0000FF">if</font>(!InitInstance(hInstance,nCmdShow))</font></b><font color="#008000">//调用InitInstance函数</font><b><font face="宋体"><br>
&nbsp;&nbsp;&nbsp; <font color="#0000FF">return</font> (F</font><font face="Arial">A</font><font face="宋体">LSE);<br>            
</font> 
</b> 
<br>
<font color="#008000">	&nbsp;&nbsp;&nbsp;          
</font>	 
<font color="#008000">	//进入消息循环，从应用程序消息队列中检取消息；&nbsp;<br>
</font>	<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font><font color="#008000"> 
</font><b><font face="宋体"><font color="#0000FF">while</font> (Get</font><font face="Arial">M</font><font face="宋体">essage(&amp;msg,NULL,0,0))<br>            
&nbsp;&nbsp;&nbsp; {</font></b><font color="#008000">//</font><font color="#008000">把虚拟键消息翻译为字符消息；</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<b><font face="宋体">Translate</font><font face="Arial">M</font><font face="宋体">essage(&amp;msg);<br>          
</font></b>
<br>
<font color="#008000">	 &nbsp;&nbsp;&nbsp;          
</font>		&nbsp;          
<font color="#008000">	 &nbsp;&nbsp;&nbsp;
</font>		 
<font color="#008000">	 //把消息分配到相应的窗口过程中去；&nbsp;<br>
</font>		<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font><font color="#008000">&nbsp;</font><b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b><font color="#008000"> 
</font><b><font face="宋体">Dispatch</font><font face="Arial">M</font><font face="宋体">essage(&amp;msg);<br>
&nbsp;&nbsp;&nbsp; }<br>          
</font></b>
<br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b><font color="#0000FF">return</font> (msg.wParam);//返回附加的消息<br>           
</b></font><b><font face="宋体">
}<br>
</font></b>
<br>
<br>
<font color="#008000">//**下面是定义要用到的函数，定义了主函数才能调用**<br>
</font><br>
<font color="#008000">///////////////////////////////////////////<br>
//   函数名：InitApplication(HINSTANCE)<br>            
// 用途是：供主函数用,初始化窗口,并注册窗口<br>           
///////////////////////////////////////////</font><br>
<br>
<b><font face="宋体">
BOOL Init</font><font face="Arial">A</font><font face="宋体">pplication(HINST</font><font face="Arial">A</font><font face="宋体">NCE hInstance)</font></b><font color="#008000">//当前实例句柄</font><br> 
<b><font face="宋体"> 
{</font></b><font color="#008000">//窗口类定义</font><br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b><font face="Arial">WNDCLASS</font><font face="宋体"> </font>
<font face="Arial">SmlWin;</font></b><font color="#008000">//定义一个WNDCLASS      
结构对象SmlWin；</font><br>      
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.style=0;</b></font><font color="#008000">//对象的基本窗口风格</font><br>         
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b> <font face="宋体">SmlWin.lpfnWndProc=(WNDPROC)</font><font face="Arial">M</font><font face="宋体">ainWndProc;</font></b><font color="#008000">//处理消息的函数</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.cbClsExtra=0;</b></font><font color="#008000">//分配给窗口类结构之后的额外字节数</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.cbWndExtra=0;</b></font><font color="#008000">//分配给窗口实例后的额外字节数</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.hInstance=hInstance;</b></font><font color="#008000">//标识窗口过程所在的实例</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.hInstance=hInstance;</b></font><font color="#008000">//标识窗口过程所在的实例</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.hIcon =LoadIcon(hInstance,IDI_APPLICATION);</b></font><font color="#008000">//加载图标</font><br>           
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.hCursor=LoadCursor(NULL,IDC_ARROW);</b></font><font color="#008000">//标识类的鼠标指针</font><br>          
<br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.hbrBackground=(HBRUSH)(14);</b></font><font color="#008000">//蓝色窗口</font><br>          
<font color="#008000">	&nbsp;&nbsp;&nbsp; //填充背景色用（HBRUSH）强制转换数据类型；<br>          
</font><br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b> <font face="宋体">SmlWin.lpsz</font><font face="Arial">M</font><font face="宋体">enuName=NULL;</font></b><font color="#008000">//无菜单</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>SmlWin.lpszClassName=&quot;SmlWinWClass&quot;;</b></font><font color="#008000">//</font><font color="#008000">标识本类名称的字符串</font><br>          
<br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b><font color="#0000FF">return</font> (RegisterClass(&amp;SmlWin));</b></font> <font color="#008000"> //注册窗口类</font><br>           
<b><font face="宋体">
}</font></b><font color="#008000">//函数定义完毕，下面是另一个定义</font><br>
<br>
<font color="#008000">///////////////////////////////////////<br>
//  函数名：InitIstance(HINSTANCE,int)<br>            
//	用 途：供主函数用,初始化窗口的各个属性<br>          
///////////////////////////////////////</font><br>
<br>
<b><font face="宋体">
BOOL InitInstance(</font></b><font color="#008000">//有两个参数；</font><br> 
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>HINSTANCE hInstance,</b></font><font color="#008000">//一个是实例句柄，</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b><font color="#0000FF">int</font> nCmdShow)</b></font><font color="#008000">//另一个是窗口的显示方式；</font><br>          
<b><font face="宋体">
{
<br>
&nbsp;&nbsp;&nbsp; hInst=hInstance;</font></b>               
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><font color="#008000">&nbsp;&nbsp;&nbsp;     
//保存当前实例句柄，供其他函数调用，hInst是一个全局变量在WinMain函数之前定义</font><br>     
<br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b> <font face="宋体">hWnd</font><font face="Arial">M</font><font face="宋体">ain=CreateWindow(</font></b><font color="#008000">//调用API函数</font><br>          
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> 
<font face="宋体"><b>&quot;SmlWinWClass</b></font><b><font face="宋体">&quot;,</font></b><font color="#008000">//上一个函数定义的窗口类名称</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b></font> <font face="宋体"><b>"蓝色荡漾&quot;,</b></font><font color="#008000">//窗口标题</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<b><font face="宋体">WS_OVERLAPPEDWINDOW,</font></b><font color="#008000">//创建标题栏的风格</font><br>          
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<font face="宋体"><b>CW_USEDEFAULT,CW_USEDEFAULT,</b></font><font color="#008000">//默认的窗口位置(x,y)</font><br>         
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<b><font face="宋体">CW_USEDEFAULT,CW_USEDEFAULT,</font></b><font color="#008000">//默认的窗口大小(宽度,高度)</font><br>         
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<font face="宋体"><b>NULL,</b></font><font color="#008000">//父窗口句柄</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<b><font face="宋体">NULL,</font></b><font color="#008000">//当前菜单句柄</font><br>          
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<font face="宋体"><b>hInstance,</b></font><font color="#008000">//当前实例句柄</font><br>          
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font>&nbsp;<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> 
<b><font face="宋体">NULL);</font></b><font color="#008000">//创建窗口的大小</font><br>          
<br>
<font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font> <b> <font face="宋体"><font color="#0000FF">if</font>(!hWnd</font><font face="Arial">M</font><font face="宋体">ain)</font></b><font color="#008000">//判断是否成功创建窗口，判断hWndMain句柄的值</font><br>          
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;<font color="#0000FF"><font face="宋体"><b>&nbsp;&nbsp;&nbsp;</b></font></font> 
<b> 
<font face="宋体"><font color="#0000FF">return</font> (FALSE);<br>            
<br>
&nbsp;&nbsp;&nbsp; ShowWindow (hWnd</font><font face="Arial">M</font><font face="宋体">ain,nCmdShow);</font></b><font color="#008000">//</font><font color="#008000">显示窗口</font><br>         
<font color="#008000">	&nbsp;&nbsp;&nbsp; //hWndMain是指定要显示窗口的句柄<br>         
&nbsp;&nbsp;&nbsp; //nCmdShow是从WinMain()函数的nCmdShow传递来的显示方式<br>         
</font><br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">UpdateWindow(hWnd</font><font face="Arial">M</font><font face="宋体">ain);</font></b><font color="#008000">//更新窗口客户区</font><br>          
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">return</font> (TRUE);</font></b><font color="#008000">//返回值TRUE</font><br>           
<font face="宋体"><b>
}<br>
</b></font>
<br>
<font color="#008000">////////////////////////////////////////////////<br>
// 函数名：MainWndProc(HWND,UINT,WPARAM,LPARAM)<br>           
// 用途是：处理窗口消息<br>           
</font><font color="#008000">////////////////////////////////////////////////<br>
</font><br>
<b>
<font face="宋体">LRESULT CALLBACK </font><font face="Arial">M</font><font face="宋体">ainWndProc(</font></b><font color="#008000">//有四个参数
</font>
<font face="宋体"><b><br>   
&nbsp;&nbsp;&nbsp; HWND hWnd,</b></font><font color="#008000">//窗口句柄</font><br>         
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">UINT message,</font></b><font color="#008000">//消息类型</font><br>           
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">WPAR</font><font face="Arial">AM</font><font face="宋体"> wParam,</font></b><font color="#008000">//消息附带信息</font><br>           
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">LP</font><font face="Arial">A</font><font face="宋体">R</font><font face="Arial">AM</font><font face="宋体"> lParam)</font></b><font color="#008000">//消息附带信息</font><br>           
<font face="宋体"><b>
{<br>
&nbsp;&nbsp;&nbsp; HDC hdc;</b></font> <font color="#008000"> //需要显示器设备来显示文本</font><br>          
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">PAINTSTRUCT ps;           
</font></b> <font color="#008000"> //使用设备的方法</font><br>
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">switch</font>(message)</font></b> <font color="#008000">  //需要自己处理的消息</font><br>           
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体">{<br>          
&nbsp;&nbsp;&nbsp; <font color="#0000FF">case</font> W</font><font face="Arial">M</font><font face="宋体">_P</font><font face="Arial">A</font><font face="宋体">INT: </font></b> <font color="#008000"> //接收WM_PAINT消息，本消息自动产生</font><br>         
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp; <b><font face="宋体">hdc=BeginPaint(hWnd,&amp;ps);</font></b> <font color="#008000"> //申请设备</font><br>           
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp; <b><font face="宋体">TextOut(hdc,20,30,myStr,lstrlen(myStr));<br>          
</font></b>
<font color="#008000">&nbsp;&nbsp;&nbsp;         
</font><b><font face="宋体">&nbsp;&nbsp;&nbsp;&nbsp; </font></b>
<font color="#008000">//myStr已经在头文件SmlWin.h中定义为字符串<br>
</font><br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp; <b><font face="宋体">EndPaint(hWnd,&amp;ps);</font></b> <font color="#008000"> //结束设备使用</font><br>           
<b><font face="宋体">&nbsp;&nbsp;&nbsp;<font color="#0000FF"> break</font></font></b><font face="宋体"><b>;</b></font><font color="#008000">//本条消息处理完毕</font>，<br>         
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">case</font> W</font><font face="Arial">M</font><font face="宋体">_DESTROY:</font></b><font color="#008000">//退出应用程序，</font><br>           
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b>&nbsp;&nbsp;&nbsp;&nbsp; <b><font face="宋体">
PostQuit</font><font face="Arial">M</font><font face="宋体">essage(0);</font></b><font color="#008000">//向系统发送一条WM_QUIT消息，</font><br>          
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">break</font>;<br>          
</font></b>
<br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">default</font>:           
</font></b> <font color="#008000"> //让系统帮着处理的消息</font><br>
<b><font face="宋体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></b> <b><font face="宋体"><font color="#0000FF">return</font> (DefWindowProc(hWnd,message,wParam,lParam));<br>            
&nbsp;&nbsp;&nbsp; }<br>         
&nbsp;&nbsp;&nbsp; <font color="#0000FF">return</font>(0);</font></b><font color="#008000">//函数返回值</font><br>         
<b><font face="宋体">
}</font></b><font color="#008000">//代码结束</font>          
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0"><b><font face="宋体"><br>
</font>
</b>　<font color="#0000FF">记着</font>经常<font color="#800000">保存<img border="0" src="images/bcann.gif" width="23" height="22"></font>，输入完成后单击“<font color="#800000">编译条</font>”上的构建按钮<img border="0" src="images/gjann.gif" width="23" height="23">，检查一下是否有错误，<font color="#800000">注意</font>拼写错误、字母大小写，一句结束的分号，和使用英文标点符号，大括号的配对，修改后及时保存，</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　“<font color="#800000">构建</font>”通过以后再单击“<font color="#800000">执行</font>”按钮<img border="0" src="images/zhxann.gif" width="23" height="23">，看看倾注自己心血的程序窗口；               
          
               
</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp;<font color="#0000FF"> 
本节</font>学习了应用程序的框架结构，可以看出有四个部分：主函数<b><font face="宋体">Win</font><font face="Arial">M</font><font face="宋体">ain</font></b>、初始化<font face="宋体">函数<b>Init</font><font face="Arial">A</font><font face="宋体">pplication</font></b>、创建函数<font face="宋体"><b>InitInstance</b></font>和消息函数<b><font face="Arial">M</font><font face="宋体">ainWndProc</font></b>，</p>
<p align="left" style="line-height: 150%; margin: 0">　</p>
<p align="left" style="line-height: 150%; margin: 0">　如果你成功地完成了练习，理解了窗口的各个组成代码，请继续学习下一课内容；</p>
<p align="left" style="line-height: 150%; margin: 0"><a href="../index.htm">返回</a></p>
<p align="left" style="line-height: 150%; margin: 0">　</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp; <a href="images/smlwin.exe">蓝色荡漾</a>              
 <font size="2">（在弹出的对话框中选择“<font color="#800000">运行</font>”、“<font color="#800000">运行</font>”）</font>           
          
               
</p>         
                
                 
<p align="left" style="line-height: 150%; margin: 0">&nbsp;&nbsp;          
          
               
</p>         
                
                 
<p style="line-height: 150%; margin-top: 0; margin-bottom: 0">          
                 
                  
<font SIZE="1" color="#008000">  
本教程由86团学校TeliuTe制作|著作权所有</font></p>
<p style="line-height: 150%; margin-top: 0; margin-bottom: 0">          
                 
                  
<font color="#008000" size="1">基础教程网：<a href="http://teliute.org/">http://teliute.org/</a></font> </p>  
<p style="line-height: 150%; margin-top: 0; margin-bottom: 0">          
                 
                  
<font SIZE="1" color="#008000">  
美丽的校园……  
</font>        
               
                
</p>  
               
                
<font color="green" style="font-size:12px"><script language="javascript" type="text/javascript" src="http://js.users.51.la/1132862.js"></script>
          	<noscript><a href="http://www.51.la/?1132862" target="_blank"><img alt="我要啦免费统计" src="http://img.users.51.la/1132862.asp" style="border:none" / width="20" height="20" /></a>
			</noscript></font><br /><br />
<div>

<table width="800" border="0" cellspacing="0" cellpadding="0" id="gg">
  <tr>
    <td>
	<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	</td>
  </tr>
  <tr>
    <td>
	<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "image";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	</td>
  </tr>
  <tr>
    <td>
	<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
	</td>
  </tr>
</table>
</div>
               
                
                     
                     
<p align="center">转载和引用本站内容，请保留版权信息和本站链接。</p></body> </html>                     
