<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head>






  <meta content="text/html; charset=UTF-8" http-equiv="content-type" />
  <meta name="author" content="TeliuTe" />
  <meta name="Copyright" content="TeliuTe,基础教程网" />
  <meta name="description" content="TeliuTe系列教程之 DRBL 操作教程" />
  <meta name="keywords" content="DRBL,无盘,教程,TeliuTe,教学,基础,入门" />

  <link rel="stylesheet" href="../css/css.css" type="text/css" />
  <link rel="Shortcut  Icon" href="../css/qcqy.ico" /><title>DRBL 基础|服务器备份</title></head><body style="direction: ltr;">
<p class="title">DRBL 操作指南</p>
<p class="green">作者：TeliuTe　来源：基础教程网</p>
<span class="tblue">五、服务器备份</span>　<a href="../index.html">返回目录</a>　<a href="../lesson6/lesson6.html">下一课</a>
<p>　设置好DRBL后，可以把一些文件备份一下；</p>
<p class="tblue">　1、配置文件</p>
<p>　1）\etc\drbl 文件夹，这个文件夹里面存放用 drblpush -i 生成的客户机的相关信息；</p>
<p>　drbl_deploy.conf 存放 drblpush 时回答的各个选项</p>
<p><div style="background-color: rgb(255, 255, 255); width: 500px; color: green;">
config_file="drblpush.conf"<br />
purge_client="yes"<br />
client_root_passwd=""<br />
client_pxelinux_passwd=""<br />
language="zh_CN.UTF-8"<br />
set_client_system_select="yes"<br />
use_graphic_pxelinux_menu="yes"<br />
set_DBN_client_audio_plugdev="yes"<br />
open_thin_client_option="no"<br />
client_system_boot_timeout="70"<br />
collect_mac=yes<br />
total_client_no=1<br />
nfs_protocol="tcp"<br />
client_init="graphic"<br />
mkswapfile="mkswapfile"<br />
ocs_img_repo_dir="/home/partimag"<br />
nfsserver_default=""<br />
nameserver="127.0.0.1"<br />
nameserver_="127.0.0.1"<br />
domain="218.202.152.130"<br />
nisdomain="teliute"<br />
public_ip_list="public_ip.drbl"<br />
login_gdm_opt="auto_login"<br />
client_autologin_passwd="st"<br />
timed_login_time=""<br />
run_drbl_ocs_live_prep="yes"<br />
drbl_ocs_live_server=""<br />
clonezilla_mode="clonezilla_box_mode"<br />
live_client_branch="alternative"<br />
live_client_cpu_mode="generic"<br />
drbl_mode="drbl_ssi_mode"<br />
sh_debug=""<br />
verbose_opt=""<br />
CLIENT_IP_HOSTNAME_LIST="IP_HOST_TABLE"<br />
drbl_server_as_NAT_server="no"<br />
add_start_drbl_services_after_cfg="yes"<br />
continue_with_one_port="y"
</div>
</p>
<p>　2）drblpush.conf 存放客户机的登录信息；</p>
<div style="background-color: rgb(255, 255, 255); width: 500px; color: green;">
#Setup for general<br />
[general]<br />
domain=218.202.152.130<br />
nisdomain=teliute<br />
localswapfile=yes<br />
client_init=graphic<br />
login_gdm_opt=auto_login<br />
timed_login_time=<br />
maxswapsize=128<br />
ocs_img_repo_dir=/home/partimag<br />
total_client_no=1<br />
create_account=<br />
account_passwd_length=8<br />
hostname=st-<br />
purge_client=yes<br />
client_autologin_passwd=st<br />
client_root_passwd=<br />
client_pxelinux_passwd=<br />
set_client_system_select=yes<br />
use_graphic_pxelinux_menu=yes<br />
set_DBN_client_audio_plugdev=yes<br />
open_thin_client_option=no<br />
client_system_boot_timeout=70<br />
language=zh_CN.UTF-8<br />
set_client_public_ip_opt=no<br />
config_file=drblpush.conf<br />
collect_mac=yes<br />
run_drbl_ocs_live_prep=yes<br />
drbl_ocs_live_server=<br />
clonezilla_mode=clonezilla_box_mode<br />
live_client_branch=alternative<br />
live_client_cpu_mode=generic<br />
drbl_mode=drbl_ssi_mode<br />
drbl_server_as_NAT_server=no<br />
add_start_drbl_services_after_cfg=yes<br />
continue_with_one_port=y<br />
<br />
#Setup for eth1<br />
[eth1]<br />
interface=eth1<br />
mac=macadr-eth1.txt<br />
ip_start=2<br />
gateway=192.168.1.100<br />
</div>
<p>　</p>
<p>　3）IP_HOST_TABLE 存放客户机分配的IP地址和机器名称；</p>
<div style="background-color: rgb(255, 255, 255); width: 500px; color: green;">
# Created by DRBL (drblpush), begin<br />
192.168.1.2 st-102<br />
192.168.1.3 st-103<br />
# Created by DRBL (drblpush), end<br />
</div>
<p>　</p>
<p>　4）macadr-eth0.txt 存放客户机的网卡 MAC 地址；</p>
<div style="background-color: rgb(255, 255, 255); width: 500px; color: green;">
08:00:27:12:2d:e1<br />
08:00:27:c5:aa:0e<br />
</div>
<p>　</p>
<p>　5）\etc\dhcp 文件夹，里面存放 drblpush -i 生成的 DHCP 配置文件；</p>
<p>　dhcpd.conf 包含客户机的网卡地址和分配的 ip 地址等网络信息</p>
<div style="background-color: rgb(255, 255, 255); width: 1024px; color: green;">
# Generated by DRBL. <br />
# Do NOT modify this file unless you know what you are doing!<br />
<br />
default-lease-time            300;<br />
max-lease-time                300;<br />
option subnet-mask            255.255.255.0;<br />
option domain-name-servers          127.0.0.1;<br />
option domain-name            "218.202.152.130";    <br />
ddns-update-style                       none;<br />
server-name                 drbl;<br />
<br />
filename = "pxelinux.0";<br />
# gpxelinux.0 features: HTTP, DNS, TFTP, iSCSI, AoE, bzImage ELF, Multiboot, PXE, PXEXT. Ref: http://ols.fedoraproject.org/OLS/Reprints-2008/anvin-reprint.pdf<br />
# filename = "gpxelinux.0";<br />
<br />
## Uncomment the following "if block" when you have some buggy PXE NIC card (such as annoying sis900 NIC). Remember to modify the MAC vendor prefix and restart dhcpd service!!!<br />
## This is a workround for some network card with BAD PXE code in firmware.<br />
## It will only affect those clients with MAC vendor prefix you assigned.<br />
## Ref: http://syslinux.zytor.com/archives/2005-August/005640.html<br />
<br />
#if substring (option vendor-class-identifier, 0, 3) = "PXE" {<br />
#     # **************************************************************<br />
#     # ***MODIFY*** the MAC vendor prefix of client network card here.<br />
#     # **************************************************************<br />
#     # For annoying sis900 network card, maybe it is 00:07:95, 00:0C:6E...<br />
#     if substring (hardware, 1, 3) = 00:0C:6E {<br />
#         # sis900.zpxe is specially for sis900 NIC, you can download it from <br />
#         # http://rom-o-matic.net/etherboot/etherboot-5.4.4/contrib/rom-o-matic<br />
#         filename = "sis900.zpxe";<br />
#     }<br />
#}<br />
<br />
# Uncomment the following to get the debug/verbose messages in system log. The messages like the following will be shown:<br />
# Client 0:c:29:3b:34:fb requests 1:2:3:5:6:b:c:d:f:10:11:12:2b:36:3c:43:80:81:82:83:84:85:86:87 - PXEClient:Arch:00000:UNDI:002001 - no dhcp-client-id<br />
# Client 0:c:29:3b:34:fb requests 1:3:6:c:f:1c:28:29:2a - DRBLClient - no dhcp-client-id<br />
# Begin of log command<br />
#log(info, concat("Client ",<br />
#        binary-to-ascii(16, 8, ":", substring(hardware, 1, 6)),<br />
#        " requests ",<br />
#        binary-to-ascii(16, 8, ":", option dhcp-parameter-request-list),<br />
#        " - ",<br />
#        pick-first-value(option vendor-class-identifier, "no vendor-id"),<br />
#        " - ",<br />
#        pick-first-value(option dhcp-client-identifier, "no dhcp-client-id"))<br />
#   );<br />
# End of log command<br />
<br />
# This class 'DRBL-Client' defines 3 kind of clients: PXE, Etherboot (1st stage) or DRBL client (2nd stage, i.e. in network initrd/initramfs (mkpxeinitrd-net)) to lease IP address.  This will only affect 'range' statement only, not the 'host' statement.<br />
# Note! The following line(s) in the pool statement: 'allow members of "DRBL-Client";' is/are commented to disable this mechanism by default.<br />
# If you do want to use this mechanism, uncomment all 'allow members of "DRBL-Client";', then only PXE, etherboot and DRBL client can lease IP address from this DHCP service.<br />
# ///NOTE/// In summary, two cases you can turn on this mechanism:<br />
# (1) This DRBL server is not used as a clonezilla server.<br />
# (2) This DRBL server is used as a Clonezilla server, with the following conditions:<br />
#     (a) 'range' statement is used in this DRBL service.<br />
#     (b) There is an existing DHCP service which can provide IP address leases to the restored OS (either GNU/inux or MS Windows) in the client. Otherwise if you uncomment 'allow members of "DRBL-Client";', restored OS won't be able to lease IP address.<br />
<br />
# The DRBL client class: PXE, Etherboot or DRBL client<br />
class "DRBL-Client" {<br />
  match if <br />
  (substring(option vendor-class-identifier, 0, 9) = "PXEClient") or<br />
  (substring(option vendor-class-identifier, 0, 9) = "Etherboot") or<br />
  (substring(option vendor-class-identifier, 0, 10) = "DRBLClient") ;<br />
}<br />
<br />
# If you want to use special port for DHCP service, edit here:<br />
# For more info, ref: http://drbl.sourceforge.net/faq/index.php#path=./2_System&entry=37_coexist_with_existing_dhcp.faq<br />
# local-port 1067;<br />
# remote-port 1068;<br />
<br />
subnet 192.168.1.0 netmask 255.255.255.0 {<br />
    option subnet-mask    255.255.255.0;<br />
    option routers 192.168.1.100;<br />
    next-server 192.168.1.251;<br />
<br />
    host st-102 {<br />
        hardware ethernet  08:00:27:12:2d:e1;<br />
        fixed-address 192.168.1.2;<br />
    # option host-name "st-102";<br />
    }<br />
    host st-103 {<br />
        hardware ethernet  08:00:27:c5:aa:0;<br />
        fixed-address 192.168.1.3;<br />
    # option host-name "st-103";<br />
    }<br />
}
</div>
<p>　</p>
<p>　<span class="tblue">本节</span>学习了备份服务器的基础知识，如果你成功地完成了练习，请继续学习下一课内容；</p>
<p><a href="../index.html">返回目录</a>　<a href="../lesson6/lesson6.html">下一课</a></p>
<p class="green">本教程由86团学校TeliuTe制作|著作权所有</p>
<p class="green">基础教程网：<a href="http://teliute.org/">http://teliute.org/</a></p>
<p class="green">美丽的校园……</p>

<p style="text-align: center;">转载和引用本站内容，请保留版权信息和本站链接。</p>

<p><script language="javascript" type="text/javascript" src="http://js.users.51.la/201022.js">
<noscript><a href="http://www.51.la/?201022" target="_blank"><img alt="我要啦免费统计" src="http://img.users.51.la/201022.asp" style="border: medium none ;" height="20" width="20" /></a> </noscript></p>

<div>

<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br />
<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "image";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script><script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<br />
<script type="text/javascript"><!--
google_ad_client = "pub-2989083345397211";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text";
//2007-09-15: new1
google_ad_channel = "9381269263";
google_ui_features = "rc:6";
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>


</p></body></html>